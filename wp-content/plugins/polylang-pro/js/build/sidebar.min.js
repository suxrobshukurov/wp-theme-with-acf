(()=>{var t={184:(t,e)=>{var n;!function(){"use strict";var s={}.hasOwnProperty;function l(){for(var t=[],e=0;e<arguments.length;e++){var n=arguments[e];if(n){var a=typeof n;if("string"===a||"number"===a)t.push(n);else if(Array.isArray(n)){if(n.length){var o=l.apply(null,n);o&&t.push(o)}}else if("object"===a)if(n.toString===Object.prototype.toString)for(var r in n)s.call(n,r)&&n[r]&&t.push(r);else t.push(n.toString())}}return t.join(" ")}t.exports?(l.default=l,t.exports=l):void 0===(n=function(){return l}.apply(e,[]))||(t.exports=n)}()},991:t=>{t.exports=function(){return this.lodash}()},514:t=>{t.exports=function(){return this.wp.apiFetch}()},893:t=>{t.exports=function(){return this.wp.components}()},576:t=>{t.exports=function(){return this.wp.compose}()},15:t=>{t.exports=function(){return this.wp.data}()},197:t=>{t.exports=function(){return this.wp.editPost}()},353:t=>{t.exports=function(){return this.wp.editSite}()},293:t=>{t.exports=function(){return this.wp.element}()},638:t=>{t.exports=function(){return this.wp.htmlEntities}()},122:t=>{t.exports=function(){return this.wp.i18n}()},19:t=>{t.exports=function(){return this.wp.keycodes}()},571:t=>{t.exports=function(){return this.wp.plugins}()},776:t=>{t.exports=function(){return this.wp.primitives}()},470:t=>{t.exports=function(){return this.wp.url}()}},e={};function n(s){var l=e[s];if(void 0!==l)return l.exports;var a=e[s]={exports:{}};return t[s](a,a.exports,n),a.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var s in e)n.o(e,s)&&!n.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var s={};(()=>{"use strict";n.r(s);var t=n(293),e=n(571),l=n(15),a=n(991),o=n(197),r=n(353),i=n(122),c=n(514),p=n.n(c),u=n(470),d=n(893),g=n(576);class h extends t.Component{constructor(){super(...arguments),this.confirmButton=(0,t.createRef)()}componentDidMount(){this.confirmButton.current.focus()}render(){const{idPrefix:e,title:n,updateState:s,handleChange:l,children:a}=this.props;return(0,t.createElement)(d.Modal,{title:n,className:"confirmBox",onRequestClose:s,shouldCloseOnEsc:!1,shouldCloseOnClickOutside:!1,focusOnMount:!1},a,(0,t.createElement)(d.ButtonGroup,{className:"buttons"},(0,t.createElement)(d.Button,{id:`${e}_confirm`,ref:this.confirmButton,isPrimary:!0,onClick:t=>{l(t),s()}},(0,i.__)("OK","polylang-pro")),(0,t.createElement)(d.Button,{id:`${e}_cancel`,isSecondary:!0,onClick:()=>s()},(0,i.__)("Cancel","polylang-pro"))))}}const m=function(e,n,s){return(0,g.createHigherOrderComponent)((l=>{class o extends t.Component{constructor(){super(...arguments),this.state={isOpen:!1,changeValue:null},this.handleChange=this.handleChange.bind(this)}handleChange(t){let e=l.getChangeValue(t);const n=this.props.currentPost;(0,a.isNil)(n)||(e={templateId:e,currentPost:n}),!(0,a.isUndefined)(l.bypassConfirmation)&&l.bypassConfirmation(this.props.translationData)?s(e):this.setState({isOpen:!0,changeValue:e})}render(){var o;const r=null===(o=this.props.translationData)||void 0===o?void 0:o.is_default_lang,i=this.props,c=Object.assign({},{...i},{handleChange:this.handleChange});return(0,t.createElement)(t.Fragment,null,(0,t.createElement)(l,c),this.state.isOpen&&(0,t.createElement)(h,{title:l.labelConfirmationModal,idPrefix:e,handleChange:()=>s(this.state.changeValue),updateState:()=>this.setState({isOpen:!1,changeValue:null})},(0,t.createElement)(n,(0,a.isNil)(r)?{}:{isDefaultLang:r})))}}return o.bypassConfirmation=l.bypassConfirmation,o.getChangeValue=l.getChangeValue,o}),"withConfirmation")},f="pll/metabox",_="core/editor",y="core/edit-site",v="core",E={languages:[],selectedLanguage:{},translatedPosts:{},fromPost:null,currentTemplatePart:{}},w=["wp_template"];function b(t){const e={};return t.forEach((function(t,e,n){this[e]=(0,a.isBoolean)(t)?t.toString():t}),e),e}function P(){return!(!document.getElementById("site-editor")&&!document.getElementById("edit-site-editor"))}function S(t){return(0,l.select)(f).getLanguages().get(t)}function C(t){return t===function(){const t=(0,l.select)(f).getLanguages();return Array.from(t.values()).find((t=>t.is_default_lang))}().slug}function T(t,e,n){const s=x(e,n),o=(0,l.select)(f).getFromPost();let r=new Map(Object.entries([]));return(0,a.isUndefined)(t)||(r=new Map(Object.entries(t))),(0,a.isNil)(o)||(0,a.isNil)(o.id)||s.forEach(((t,e)=>{(0,a.isNil)(t.translated_post)||(0,a.isNil)(t.translated_post.id)||r.set(e,t.translated_post.id)})),r}function N(t){let e=new Map(Object.entries([]));return(0,a.isUndefined)(t)||(e=new Map(Object.entries(t))),e}function x(t,e){let n=new Map(Object.entries([]));return(0,a.isUndefined)(t)||(n=new Map(Object.entries(t))),n}function L(t){let e={};return t.forEach((t=>{t.is_default_lang&&(e=t.lang)})),e}var k=n(776);const A=!(0,a.isUndefined)(wp.primitives)?(0,t.createElement)(k.SVG,{width:"20",height:"20",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},(0,t.createElement)(k.Path,{d:"M6 15v-13h10v13h-10zM5 16h8v2h-10v-13h2v11z"})):"admin-page",O=!(0,a.isUndefined)(wp.primitives)?(0,t.createElement)(k.SVG,{width:"20",height:"20",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},(0,t.createElement)(k.Path,{d:"M13.89 3.39l2.71 2.72c0.46 0.46 0.42 1.24 0.030 1.64l-8.010 8.020-5.56 1.16 1.16-5.58s7.6-7.63 7.99-8.030c0.39-0.39 1.22-0.39 1.68 0.070zM11.16 6.18l-5.59 5.61 1.11 1.11 5.54-5.65zM8.19 14.41l5.58-5.6-1.070-1.080-5.59 5.6z"})):"edit",U=!(0,a.isUndefined)(wp.primitives)?(0,t.createElement)(k.SVG,{width:"20",height:"20",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},(0,t.createElement)(k.Path,{d:"M17 7v3h-5v5h-3v-5h-5v-3h5v-5h3v5h5z"})):"plus",D=!(0,a.isUndefined)(wp.primitives)?(0,t.createElement)(k.SVG,{width:"20",height:"20",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},(0,t.createElement)(k.Path,{d:"M5 7v3l-2 1.5v-6.5h11v-2l4 3.010-4 2.99v-2h-9zM15 13v-3l2-1.5v6.5h-11v2l-4-3.010 4-2.99v2h9z"})):"controls-repeat",M=!(0,a.isUndefined)(wp.primitives)?(0,t.createElement)(k.SVG,{width:"20",height:"20",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},(0,t.createElement)(k.Path,{d:"M11 7H9.49c-.63 0-1.25.3-1.59.7L7 5H4.13l-2.39 7h1.69l.74-2H7v4H2c-1.1 0-2-.9-2-2V5c0-1.1.9-2 2-2h7c1.1 0 2 .9 2 2v2zM6.51 9H4.49l1-2.93zM10 8h7c1.1 0 2 .9 2 2v7c0 1.1-.9 2-2 2h-7c-1.1 0-2-.9-2-2v-7c0-1.1.9-2 2-2zm7.25 5v-1.08h-3.17V9.75h-1.16v2.17H9.75V13h1.28c.11.85.56 1.85 1.28 2.62-.87.36-1.89.62-2.31.62-.01.02.22.97.2 1.46.84 0 2.21-.5 3.28-1.15 1.09.65 2.48 1.15 3.34 1.15-.02-.49.2-1.44.2-1.46-.43 0-1.49-.27-2.38-.63.7-.77 1.14-1.77 1.25-2.61h1.36zm-3.81 1.93c-.5-.46-.85-1.13-1.01-1.93h2.09c-.17.8-.51 1.47-1 1.93l-.04.03s-.03-.02-.04-.03z"})):"translation",R=!(0,a.isUndefined)(wp.primitives)?(0,t.createElement)(k.SVG,{width:"20",height:"20",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},(0,t.createElement)(k.Path,{d:"M12 4h3c.6 0 1 .4 1 1v1H3V5c0-.6.5-1 1-1h3c.2-1.1 1.3-2 2.5-2s2.3.9 2.5 2zM8 4h3c-.2-.6-.9-1-1.5-1S8.2 3.4 8 4zM4 7h11l-.9 10.1c0 .5-.5.9-1 .9H5.9c-.5 0-.9-.4-1-.9L4 7z"})):"trash",F=!(0,a.isUndefined)(wp.primitives)?(0,t.createElement)(k.SVG,{width:"20",height:"20",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},(0,t.createElement)(k.Path,{d:"m10 1 3 6 6 .75-4.12 4.62L16 19l-6-3-6 3 1.13-6.63L1 7.75 7 7z"})):"star-filled";const z=function(e){let{language:n}=e;return(0,a.isNil)(n)?(0,t.createElement)("span",{className:"pll-translation-icon"},M):(0,a.isEmpty)(n.flag_url)?(0,t.createElement)("abbr",null,n.slug,(0,t.createElement)("span",{className:"screen-reader-text"},n.name)):(0,t.createElement)("span",{className:"pll-select-flag"},(0,t.createElement)("img",{src:n.flag_url,alt:n.name,title:n.name,className:"flag"}))};function I(e){let{handleChange:n,children:s,selectedLanguage:l=null,defaultValue:a=""}=e;const o=null!=l&&l.slug?l.slug:a;return(0,t.createElement)("div",{id:"select-post-language"},(0,t.createElement)(z,{language:l}),s&&(0,t.createElement)("select",{value:o,onChange:t=>n(t),id:"pll_post_lang_choice",name:"pll_post_lang_choice",className:"post_lang_choice"},s))}function B(e){let{languages:n}=e;return Array.from(n.values()).map((e=>{let{slug:n,name:s,w3c:l}=e;return(0,t.createElement)("option",{value:n,lang:l,key:n},s)}))}class V extends t.Component{static bypassConfirmation(){const t=(0,l.select)(_);return!t.getEditedPostAttribute("title")&&!t.getEditedPostContent()&&!t.getEditedPostAttribute("excerpt")}static getChangeValue(t){return t.target.value}static handleLanguageChange(t){const e=(0,l.select)(_).getEditedPostAttribute("lang"),n=(0,l.select)(_).getCurrentPostId(),s=(0,l.select)(f).getLanguages().get(t),a=S(e),o=N((0,l.select)(_).getEditedPostAttribute("pll_sync_post")),r=(0,l.select)(_).getEditedPostAttribute("translations_table"),i=T((0,l.select)(_).getEditedPostAttribute("translations"),r,a.slug),c=x(r,a.slug);i.delete(a.slug),i.set(s.slug,n),o.delete(a.slug);const p=c.get(a.slug);c.set(a.slug,{can_synchronize:p.can_synchronize,lang:p.lang,links:{add_link:p.links.add_link}});const u=c.get(s.slug);c.set(s.slug,{can_synchronize:u.can_synchronize,lang:u.lang,links:p.links,translated_post:p.translated_post}),pll_block_editor_plugin_settings=s,(0,l.dispatch)(_).editPost({lang:s.slug}),(0,l.dispatch)(_).editPost({pll_sync_post:b(o)}),(0,l.dispatch)(_).editPost({translations:b(i)}),(0,l.dispatch)(_).editPost({translations_table:b(c)}),(0,l.dispatch)(_).savePost(),V.forceLanguageSave(a.slug),V.invalidateParentPagesStoredInCore()}static forceLanguageSave(t){const e=(0,l.select)(_);e.getEditedPostAttribute("title")||e.getEditedPostContent()||e.getEditedPostAttribute("excerpt")||p()({path:(0,u.addQueryArgs)(`wp/v2/posts/${e.getCurrentPostId()}`,{lang:t}),method:"POST"})}static invalidateParentPagesStoredInCore(){const t=(0,l.select)(_).getCurrentPostId(),e=(0,l.select)(_).getEditedPostAttribute("type"),n={per_page:-1,exclude:t,parent_exclude:t,orderby:"menu_order",order:"asc"};(0,l.dispatch)("core/data").invalidateResolution("core","getEntityRecords",["postType",e,n])}render(){const e=(0,l.select)(f).getLanguages(),n=S((0,l.select)(_).getEditedPostAttribute("lang"));return(0,t.createElement)(t.Fragment,null,(0,t.createElement)("p",null,(0,t.createElement)("strong",null,(0,i.__)("Language","polylang-pro"))),(0,t.createElement)("label",{className:"screen-reader-text",htmlFor:"pll_post_lang_choice"},(0,i.__)("Language","polylang-pro")),(0,t.createElement)(I,{selectedLanguage:n,handleChange:this.props.handleChange},(0,t.createElement)(B,{languages:e})))}}V.labelConfirmationModal=(0,i.__)("Change language","polylang-pro");const j=m("pll_change_lang",(function(){return(0,t.createElement)("p",null,(0,i.__)("Are you sure you want to change the language of the current content?","polylang-pro"))}),V.handleLanguageChange)(V),W=()=>(0,t.createElement)(t.Fragment,null,(0,t.createElement)(d.Icon,{icon:F,className:"pll-defaut-lang-icon"}),(0,t.createElement)("span",{className:"screen-reader-text"},(0,i.__)("Default language.","polylang-pro")));class $ extends t.Component{constructor(){super(...arguments),this.state={isDefaultLanguage:this.props.language.slug===L(this.props.translationsTable).slug}}render(){return(0,t.createElement)(t.Fragment,null,(0,t.createElement)("p",null,(0,t.createElement)("strong",null,(0,i.__)("Language","polylang-pro"))),(0,t.createElement)("div",{className:"pll-language-item"},(0,t.createElement)(z,{language:this.props.language}),(0,t.createElement)("span",{className:"pll-language-name"},(0,i.__)(this.props.language.name,"polylang-pro")),this.state.isDefaultLanguage&&(0,t.createElement)(W,null)),this.state.isDefaultLanguage&&(0,t.createElement)("div",null,(0,t.createElement)("span",{className:"pll-metabox-info"},(0,i.__)("This template parts is used for languages that have not yet been translated.","polylang-pro"))))}}const H=$;class G extends t.Component{constructor(){super(...arguments);const t=(0,l.select)(f).getCurrentUser();this.postType=P()?(0,l.select)(y).getEditedPostType():(0,l.select)(_).getCurrentPostType(),this.state={isDuplicateActive:this.isDuplicateActive(t),currentUser:t},this.handleDuplicateContentChange=this.handleDuplicateContentChange.bind(this),this.setState=this.setState.bind(this)}isDuplicateActive(t){return void 0!==typeof t.pll_duplicate_content&&void 0!==typeof t.pll_duplicate_content[this.postType]&&t.pll_duplicate_content[this.postType]}handleDuplicateContentChange(t){const e=this.state.currentUser;(0,a.isString)(e.pll_duplicate_content)&&(e.pll_duplicate_content={}),e.pll_duplicate_content[this.postType]=!this.state.isDuplicateActive,this.setState({currentUser:e,isDuplicateActive:!this.state.isDuplicateActive}),(0,l.dispatch)(f).setCurrentUser({pll_duplicate_content:e.pll_duplicate_content},!0)}render(){const e=this.state.isDuplicateActive,n=this.state.isDuplicateActive?(0,i.__)("Deactivate the content duplication","polylang-pro"):(0,i.__)("Activate the content duplication","polylang-pro");return(0,t.createElement)(d.IconButton,{id:"pll-duplicate",className:`pll-button ${e&&"wp-ui-text-highlight"}`,onClick:this.handleDuplicateContentChange,icon:A,label:n},(0,t.createElement)("span",{className:"screen-reader-text"},n))}}const K=G;class q extends t.Component{constructor(){super(...arguments)}static handleSynchronizationChange(t){const e=N((0,l.select)(_).getEditedPostAttribute("pll_sync_post"));e.has(t)?e.delete(t):e.set(t,!0),(0,l.dispatch)(_).editPost({pll_sync_post:b(e)}),(0,l.dispatch)(_).editPost({title:(0,l.select)(_).getEditedPostAttribute("title")})}static bypassConfirmation(t){const e=N((0,l.select)(_).getEditedPostAttribute("pll_sync_post")),n=!(0,a.isEmpty)(e)&&e.has(t.lang.slug),s=!(0,a.isUndefined)(t.translated_post)&&!(0,a.isNil)(t.translated_post.id);return n||!s}static getChangeValue(t){return t.currentTarget.id.match(/\[(.[^[]+)\]/i)[1]}render(){const e=N((0,l.select)(_).getEditedPostAttribute("pll_sync_post")),n=this.props.translationData,s=!(0,a.isEmpty)(e)&&e.has(n.lang.slug),o=s&&"wp-ui-text-highlight",r=s?(0,i.__)("Don't synchronize this post","polylang-pro"):(0,i.__)("Synchronize this post","polylang-pro");return(0,t.createElement)(d.IconButton,{icon:D,label:r,id:`pll_sync_post[${n.lang.slug}]`,className:`pll-button ${o}`,onClick:t=>{this.props.handleChange(t)}},(0,t.createElement)("span",{className:"screen-reader-text"},r))}}q.labelConfirmationModal=(0,i.__)("Synchronize this post","polylang-pro");const Q=m("pll_sync_post",(function(){return(0,t.createElement)("p",null,(0,i.__)("You are about to overwrite an existing translation. Are you sure you want to proceed?","polylang-pro"))}),q.handleSynchronizationChange)(q),Y={setLanguages:t=>({type:"SET_LANGUAGES",languages:t}),setCurrentUser(t){return{type:"SET_CURRENT_USER",currentUser:t,save:arguments.length>1&&void 0!==arguments[1]&&arguments[1]}},setFromPost:t=>({type:"SET_FROM_POST",fromPost:t}),fetchFromAPI:t=>({type:"FETCH_FROM_API",options:t}),setCurrentTemplatePart:t=>({type:"SET_CURRENT_TEMPLATE_PART",currentTemplatePart:t})},X=(0,l.createReduxStore)(f,{reducer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"SET_LANGUAGES":return{...t,languages:e.languages};case"SET_CURRENT_USER":return e.save&&(n=e.currentUser,p()({path:"/wp/v2/users/me",data:n,method:"POST"})),{...t,currentUser:e.currentUser};case"SET_FROM_POST":return{...t,fromPost:e.fromPost};case"SET_CURRENT_TEMPLATE_PART":return{...t,currentTemplatePart:e.currentTemplatePart};default:return t}var n},selectors:{getLanguages:t=>t.languages,getCurrentUser:t=>t.currentUser,getFromPost:t=>t.fromPost,getCurrentTemplatePart:t=>t.currentTemplatePart},actions:Y,controls:{FETCH_FROM_API:t=>p()({...t.options})},resolvers:{*getLanguages(){const t=yield Y.fetchFromAPI({path:"/pll/v1/languages",filterLang:!1});return Y.setLanguages(function(t,e){const n=new Map;return t.reduce((function(t,n){return t.set(n[e],n),t}),n),n}(t,"slug"))},*getCurrentUser(){const t=yield Y.fetchFromAPI({path:"/wp/v2/users/me",filterLang:!0});return Y.setCurrentUser(t)},*getCurrentTemplatePart(){const t=tt();return Y.setCurrentTemplatePart(t)}}});(0,l.register)(X);const J=new Promise((function(t){let e=(0,l.subscribe)((function(){(0,l.select)(f).getLanguages().size>0&&(e(),t())}))}));function Z(){const t=(window.location.search,(0,a.isEmpty)(window.location.search)?null:new URLSearchParams(window.location.search));null!==t&&(0,l.dispatch)(f).setFromPost({id:wp.sanitize.stripTagsAndEncodeText(t.get("from_post")),postType:wp.sanitize.stripTagsAndEncodeText(t.get("post_type")),newLanguage:wp.sanitize.stripTagsAndEncodeText(t.get("new_lang"))})}function tt(){var t,e;const n=null===(t=(0,l.select)(y))||void 0===t?void 0:t.getEditedPostId(),s=null===(e=(0,l.select)(y))||void 0===e?void 0:e.getEditedPostType();return(0,l.select)(v).getEntityRecord("postType",s,n)}const et=t=>{const e=t.target.closest("a.pll-button").getAttribute("data-target-language"),n=tt(),s={[n.lang]:n.wp_id},o=(0,l.select)(f).getCurrentUser().pll_duplicate_content.wp_template_part?n.content.raw:"",r=function(){let t="[a-z_-]+";const e=(0,l.select)(f).getLanguages(),n=Array.from(e.keys());return(0,a.isEmpty)(n)||(t=n.join("|")),new RegExp(`___(?:${t})$`)}(),i=n.slug.replace(r,"");p()({path:"/wp/v2/template-parts",method:"POST",data:{slug:i,title:n.title.raw,content:o,area:n.area,lang:e,from_post:n.wp_id,translations:s}}).then((t=>{var n;const s=null===(n=(0,a.get)(t.translations_table,e))||void 0===n?void 0:n.links.edit_link;(0,a.isNil)(s)||(location.href=s)}))},nt=e=>{let{translationData:n}=e;const s=!(0,a.isUndefined)(n.translated_post)&&!(0,a.isNil)(n.translated_post.id),l=!(0,a.isUndefined)(n.links)&&!(0,a.isNil)(n.links.edit_link),o=!(0,a.isUndefined)(n.links)&&!(0,a.isEmpty)(n.links.add_link);let r=U,c=(0,i.sprintf)((0,i.__)("Add a translation in %s","polylang-pro"),n.lang.name),p=decodeURI(n.links.add_link);return s&&(r=O,c=(0,i.sprintf)((0,i.__)("Edit the translation in %s","polylang-pro"),n.lang.name),p=decodeURI(n.links.edit_link)),!o&&!s||!l&&s?null:P()&&!s?(0,t.createElement)(d.Button,{href:"#",icon:r,label:c,className:"pll-button",onClick:et,"data-target-language":n.lang.slug},(0,t.createElement)("span",{className:"screen-reader-text"},c)):(0,t.createElement)(d.Button,{href:p,icon:r,label:c,className:"pll-button"},(0,t.createElement)("span",{className:"screen-reader-text"},c))};var st=n(184),lt=n.n(st);function at(t){return at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},at(t)}function ot(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,s)}return n}function it(t,e){var n=t["page".concat(e?"Y":"X","Offset")],s="scroll".concat(e?"Top":"Left");if("number"!=typeof n){var l=t.document;"number"!=typeof(n=l.documentElement[s])&&(n=l.body[s])}return n}function ct(t){return it(t)}function pt(t){return it(t,!0)}function ut(t){var e=function(t){var e,n,s,l=t.ownerDocument,a=l.body,o=l&&l.documentElement;return n=(e=t.getBoundingClientRect()).left,s=e.top,{left:n-=o.clientLeft||a.clientLeft||0,top:s-=o.clientTop||a.clientTop||0}}(t),n=t.ownerDocument,s=n.defaultView||n.parentWindow;return e.left+=ct(s),e.top+=pt(s),e}var dt,gt=new RegExp("^(".concat(/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,")(?!px)[a-z%]+$"),"i"),ht=/^(top|right|bottom|left)$/;function mt(t,e){for(var n=0;n<t.length;n++)e(t[n])}function ft(t){return"border-box"===dt(t,"boxSizing")}"undefined"!=typeof window&&(dt=window.getComputedStyle?function(t,e,n){var s="",l=t.ownerDocument,a=n||l.defaultView.getComputedStyle(t,null);return a&&(s=a.getPropertyValue(e)||a[e]),s}:function(t,e){var n=t.currentStyle&&t.currentStyle[e];if(gt.test(n)&&!ht.test(e)){var s=t.style,l=s.left,a=t.runtimeStyle.left;t.runtimeStyle.left=t.currentStyle.left,s.left="fontSize"===e?"1em":n||0,n=s.pixelLeft+"px",s.left=l,t.runtimeStyle.left=a}return""===n?"auto":n});var _t=["margin","border","padding"];function yt(t,e,n){var s,l={},a=t.style;for(s in e)e.hasOwnProperty(s)&&(l[s]=a[s],a[s]=e[s]);for(s in n.call(t),e)e.hasOwnProperty(s)&&(a[s]=l[s])}function vt(t,e,n){var s,l,a,o=0;for(l=0;l<e.length;l++)if(s=e[l])for(a=0;a<n.length;a++){var r=void 0;r="border"===s?"".concat(s+n[a],"Width"):s+n[a],o+=parseFloat(dt(t,r))||0}return o}function Et(t){return null!=t&&t==t.window}var wt={};function bt(t,e,n){if(Et(t))return"width"===e?wt.viewportWidth(t):wt.viewportHeight(t);if(9===t.nodeType)return"width"===e?wt.docWidth(t):wt.docHeight(t);var s="width"===e?["Left","Right"]:["Top","Bottom"],l="width"===e?t.offsetWidth:t.offsetHeight,a=(dt(t),ft(t)),o=0;(null==l||l<=0)&&(l=void 0,(null==(o=dt(t,e))||Number(o)<0)&&(o=t.style[e]||0),o=parseFloat(o)||0),void 0===n&&(n=a?1:-1);var r=void 0!==l||a,i=l||o;if(-1===n)return r?i-vt(t,["border","padding"],s):o;if(r){var c=2===n?-vt(t,["border"],s):vt(t,["margin"],s);return i+(1===n?0:c)}return o+vt(t,_t.slice(n),s)}mt(["Width","Height"],(function(t){wt["doc".concat(t)]=function(e){var n=e.document;return Math.max(n.documentElement["scroll".concat(t)],n.body["scroll".concat(t)],wt["viewport".concat(t)](n))},wt["viewport".concat(t)]=function(e){var n="client".concat(t),s=e.document,l=s.body,a=s.documentElement[n];return"CSS1Compat"===s.compatMode&&a||l&&l[n]||a}}));var Pt={position:"absolute",visibility:"hidden",display:"block"};function St(t){var e,n=arguments;return 0!==t.offsetWidth?e=bt.apply(void 0,n):yt(t,Pt,(function(){e=bt.apply(void 0,n)})),e}function Ct(t,e,n){var s=n;if("object"!==at(e))return void 0!==s?("number"==typeof s&&(s+="px"),void(t.style[e]=s)):dt(t,e);for(var l in e)e.hasOwnProperty(l)&&Ct(t,l,e[l])}mt(["width","height"],(function(t){var e=t.charAt(0).toUpperCase()+t.slice(1);wt["outer".concat(e)]=function(e,n){return e&&St(e,t,n?0:1)};var n="width"===t?["Left","Right"]:["Top","Bottom"];wt[t]=function(e,s){if(void 0===s)return e&&St(e,t,-1);if(e){dt(e);return ft(e)&&(s+=vt(e,["padding","border"],n)),Ct(e,t,s)}}}));var Tt=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?rt(n,!0).forEach((function(e){ot(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rt(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({getWindow:function(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow},offset:function(t,e){if(void 0===e)return ut(t);!function(t,e){"static"===Ct(t,"position")&&(t.style.position="relative");var n,s,l=ut(t),a={};for(s in e)e.hasOwnProperty(s)&&(n=parseFloat(Ct(t,s))||0,a[s]=n+e[s]-l[s]);Ct(t,a)}(t,e)},isWindow:Et,each:mt,css:Ct,clone:function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);if(t.overflow)for(var s in t)t.hasOwnProperty(s)&&(e.overflow[s]=t.overflow[s]);return e},scrollLeft:function(t,e){if(Et(t)){if(void 0===e)return ct(t);window.scrollTo(e,pt(t))}else{if(void 0===e)return t.scrollLeft;t.scrollLeft=e}},scrollTop:function(t,e){if(Et(t)){if(void 0===e)return pt(t);window.scrollTo(ct(t),e)}else{if(void 0===e)return t.scrollTop;t.scrollTop=e}},viewportWidth:0,viewportHeight:0},wt);const Nt=function(t,e,n){n=n||{},9===e.nodeType&&(e=Tt.getWindow(e));var s=n.allowHorizontalScroll,l=n.onlyScrollIfNeeded,a=n.alignWithTop,o=n.alignWithLeft,r=n.offsetTop||0,i=n.offsetLeft||0,c=n.offsetBottom||0,p=n.offsetRight||0;s=void 0===s||s;var u,d,g,h,m,f,_,y,v,E,w=Tt.isWindow(e),b=Tt.offset(t),P=Tt.outerHeight(t),S=Tt.outerWidth(t);w?(_=e,E=Tt.height(_),v=Tt.width(_),y={left:Tt.scrollLeft(_),top:Tt.scrollTop(_)},m={left:b.left-y.left-i,top:b.top-y.top-r},f={left:b.left+S-(y.left+v)+p,top:b.top+P-(y.top+E)+c},h=y):(u=Tt.offset(e),d=e.clientHeight,g=e.clientWidth,h={left:e.scrollLeft,top:e.scrollTop},m={left:b.left-(u.left+(parseFloat(Tt.css(e,"borderLeftWidth"))||0))-i,top:b.top-(u.top+(parseFloat(Tt.css(e,"borderTopWidth"))||0))-r},f={left:b.left+S-(u.left+g+(parseFloat(Tt.css(e,"borderRightWidth"))||0))+p,top:b.top+P-(u.top+d+(parseFloat(Tt.css(e,"borderBottomWidth"))||0))+c}),m.top<0||f.top>0?!0===a?Tt.scrollTop(e,h.top+m.top):!1===a?Tt.scrollTop(e,h.top+f.top):m.top<0?Tt.scrollTop(e,h.top+m.top):Tt.scrollTop(e,h.top+f.top):l||((a=void 0===a||!!a)?Tt.scrollTop(e,h.top+m.top):Tt.scrollTop(e,h.top+f.top)),s&&(m.left<0||f.left>0?!0===o?Tt.scrollLeft(e,h.left+m.left):!1===o?Tt.scrollLeft(e,h.left+f.left):m.left<0?Tt.scrollLeft(e,h.left+m.left):Tt.scrollLeft(e,h.left+f.left):l||((o=void 0===o||!!o)?Tt.scrollLeft(e,h.left+m.left):Tt.scrollLeft(e,h.left+f.left)))};var xt=n(638),Lt=n(19);const kt=t=>t.stopPropagation();class At extends t.Component{constructor(){super(...arguments),this.onChange=this.onChange.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.bindListNode=this.bindListNode.bind(this),this.updateSuggestions=(0,a.throttle)(this.updateSuggestions.bind(this),200),this.suggestionNodes=[],this.state={posts:[],showSuggestions:!1,selectedSuggestion:null}}componentDidUpdate(){const{showSuggestions:t,selectedSuggestion:e}=this.state;t&&null!==e&&!this.scrollingIntoView&&(this.scrollingIntoView=!0,Nt(this.suggestionNodes[e],this.listNode,{onlyScrollIfNeeded:!0}),setTimeout((()=>{this.scrollingIntoView=!1}),100))}componentWillUnmount(){delete this.suggestionsRequest}bindListNode(t){this.listNode=t}bindSuggestionNode(t){return e=>{this.suggestionNodes[t]=e}}updateSuggestions(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t.length<2&&!e)return void this.setState({showSuggestions:!1,selectedSuggestion:null,loading:!1});this.setState({selectedSuggestion:null,loading:!0});const n=(0,l.select)(_).getCurrentPostId(),s=(0,l.select)(_).getCurrentPostType(),a=(0,l.select)(_).getEditedPostAttribute("lang"),o=this.props.translationData.lang.slug,r=p()({path:(0,u.addQueryArgs)("/pll/v1/untranslated-posts",{search:t,include:n,untranslated_in:a,lang:o,type:s,is_block_editor:!0})});r.then((t=>{this.suggestionsRequest===r&&(this.setState({posts:t,showSuggestions:!0,loading:!1}),t.length?this.props.debouncedSpeak((0,i.sprintf)((0,i._n)("%d result found, use up and down arrow keys to navigate.","%d results found, use up and down arrow keys to navigate.",t.length,"polylang-pro"),t.length),"assertive"):this.props.debouncedSpeak((0,i.__)("No results.","polylang-pro"),"assertive"))})).catch((()=>{this.suggestionsRequest===r&&this.setState({loading:!1})})),this.suggestionsRequest=r}onChange(t){const e=t.target.value,n=this.props.translatedPosts,s=this.props.translationsTable,l=this.props.translationData.lang;this.props.onChange({value:e,translatedPosts:n,translationsTable:s,language:l}),this.updateSuggestions(e)}onKeyDown(t){const{showSuggestions:e,selectedSuggestion:n,posts:s,loading:l}=this.state;let o=t.target.value,r=!1;if(e&&s.length&&!l)switch(t.keyCode){case Lt.UP:{t.stopPropagation(),t.preventDefault();const e=n?n-1:s.length-1;this.setState({selectedSuggestion:e});break}case Lt.DOWN:{t.stopPropagation(),t.preventDefault();const e=null===n||n===s.length-1?0:n+1;this.setState({selectedSuggestion:e});break}case Lt.ENTER:if(null!==this.state.selectedSuggestion){t.stopPropagation();const e=this.state.posts[this.state.selectedSuggestion];this.selectLink(e)}break;case Lt.ESCAPE:t.stopPropagation(),this.setState({selectedSuggestion:null,showSuggestions:!1})}else{switch(t.keyCode){case Lt.SPACE:const{ctrlKey:e,shiftKey:n,altKey:s,metaKey:l}=t;e&&!(n||s||l)&&(o="",r=!0);break;case Lt.BACKSPACE:(0,a.isEmpty)(o)&&(r=!0)}r&&this.updateSuggestions(o,!0)}}selectLink(t){const e=this.props.translationsTable,n=this.props.translatedPosts,s=this.props.translationData.lang;this.props.onChange({value:t.title.rendered,post:t,translatedPosts:n,translationsTable:e,language:s}),this.setState({selectedSuggestion:null,showSuggestions:!1})}render(){const{value:e="",autoFocus:n=!0,instanceId:s,translationData:l}=this.props,o=l.lang,{showSuggestions:r,posts:c,selectedSuggestion:p,loading:u}=this.state,g=!(0,a.isUndefined)(l.links)&&((0,a.isUndefined)(l.links.edit_link)||!(0,a.isUndefined)(l.links.edit_link)&&!(0,a.isNull)(l.links.edit_link));return(0,t.createElement)(t.Fragment,null,(0,t.createElement)("div",{className:"translation-input"},(0,t.createElement)("input",{lang:o.w3c,dir:o.is_rtl?"rtl":"ltr",style:{direction:o.is_rtl?"rtl":"ltr"},autoFocus:n,disabled:!g,type:"text","aria-label":(0,i.__)("URL","polylang-pro"),required:!0,value:e,onChange:this.onChange,onInput:kt,placeholder:(0,i.__)("Start typing the post title","polylang-pro"),onKeyDown:this.onKeyDown,role:"combobox","aria-expanded":r,"aria-autocomplete":"list","aria-owns":`translation-input-suggestions-${s}`,"aria-activedescendant":null!==p?`translation-input-suggestion-${s}-${p}`:void 0}),u&&(0,t.createElement)(d.Spinner,null)),r&&!!c.length&&(0,t.createElement)(d.Popover,{position:"bottom",noArrow:!0,focusOnMount:!1},(0,t.createElement)("div",{className:"translation-input__suggestions",id:`translation-input-suggestions-${s}`,ref:this.bindListNode,role:"listbox"},c.map(((e,n)=>(0,t.createElement)("button",{key:e.id,role:"option",tabIndex:"-1",id:`translation-input-suggestion-${s}-${n}`,ref:this.bindSuggestionNode(n),className:lt()("translation-input__suggestion",{"is-selected":n===p}),onClick:()=>this.selectLink(e),"aria-selected":n===p},(0,xt.decodeEntities)(e.title.rendered)||(0,i.__)("(no title)","polylang-pro")))))))}}const Ot=(0,d.withSpokenMessages)((0,g.withInstanceId)(At));function Ut(){return Ut=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Ut.apply(this,arguments)}class Dt extends t.Component{static handleDelete(t){let{templateId:e,currentPost:n}=t;if(!(0,a.isEmpty)(e)){const t=function(t){const e=(0,l.select)("core").getEntitiesByKind("postType"),n=(0,a.find)(e,{name:t});return null==n?void 0:n.baseURL}(n.type);p()({path:`${t}/${e}`,method:"GET"}).then((t=>{if(!(0,a.isEmpty)(t)){const{translations_table:e,translations:s}=n,a=x(e).get(t.lang);t.title.rendered=t.title.rendered+" in "+a.lang.name,(0,l.dispatch)(y).removeTemplate(t),delete a.translated_post;const o=T(s);o.delete(t.lang),n.translations=b(o),(0,l.dispatch)(y).setTemplatePart(n.id),C(a.lang.slug)&&(location.href=(0,u.removeQueryArgs)(location.href,"postId"))}}))}}static getChangeValue(t){const e=t.currentTarget.id;return(0,a.isEmpty)(e)?"":e.match(/\[(.[^[]+)\]/i)[1]}render(){const{lang:e,translated_post:n,links:s,template:l}=this.props.translationData,o=(0,i.sprintf)((0,i.__)("Delete the translation in %s","polylang-pro"),e.name),r=!(0,a.isUndefined)(s.delete_link),c=!(0,a.isUndefined)(n)&&!(0,a.isNil)(n.id);return r?(0,t.createElement)(d.Button,Ut({icon:R,label:o,disabled:!c},l?{id:`templateId[${l.id}]`}:{},{className:"pll-button",onClick:this.props.handleChange}),(0,t.createElement)("span",{className:"screen-reader-text"},o)):null}}Dt.labelConfirmationModal=(0,i.__)("Delete template parts confirmation","polylang-pro");const Mt=m("pll_delete_translation",(e=>{let{isDefaultLang:n}=e;return(0,t.createElement)(t.Fragment,null,n&&(0,t.createElement)("p",null,(0,i.__)("You are about to delete the template parts in the default language.","polylang-pro"),(0,t.createElement)("br",null),(0,i.__)("This will delete its customization and all its corresponding translations.","polylang-pro")),(0,t.createElement)("p",null,(0,i.__)("Are you sure you want to delete this template parts?","polylang-pro")))}),Dt.handleDelete)(Dt),Rt=t=>{let{value:e,post:n=null,translatedPosts:s,translationsTable:o,language:r}=t;const i=o.get(r.slug);(0,a.isEmpty)(n)?(i.translated_post={id:null,title:e},i.links={add_link:i.links.add_link},s.delete(r.slug)):(s.set(r.slug,n.id),i.translated_post={id:n.id,title:n.title.rendered},i.links.edit_link=n.edit_link),o.set(r.slug,i),(0,l.dispatch)(_).editPost({translations:b(s)}),(0,l.dispatch)(_).editPost({title:(0,l.select)(_).getEditedPostAttribute("title")})},Ft=e=>{let{selectedLanguage:n,translationsTable:s,translatedPosts:l,currentPost:o}=e;return(0,t.createElement)("div",{id:"post-translations",className:"translations"},(0,t.createElement)("p",null,(0,t.createElement)("strong",null,(0,i.__)("Translations","polylang-pro"))),(0,t.createElement)("table",null,(0,t.createElement)("tbody",null,Array.from(s.values()).map((e=>n.slug!==e.lang.slug&&(0,t.createElement)("tr",{key:e.lang.slug},(0,t.createElement)("th",{className:"pll-language-column"},(0,a.isEmpty)(e.lang.flag)?(0,t.createElement)("abbr",null,e.lang.slug,(0,t.createElement)("span",{className:"screen-reader-text"},e.lang.name)):(0,t.createElement)("span",{className:"pll-select-flag flag"},(0,t.createElement)("img",{src:e.lang.flag_url,alt:e.lang.name,title:e.lang.name}))),P()&&(0,t.createElement)(t.Fragment,null,(0,t.createElement)("td",{className:"pll-translation-column"},(0,t.createElement)("span",{className:"pll-translation-language"},e.lang.name)),(0,t.createElement)("td",{className:"pll-edit-column pll-column-icon"},(0,t.createElement)(nt,{translationData:e})),(0,t.createElement)("td",{className:"pll-delete-column pll-column-icon"},(0,t.createElement)(Mt,{translationData:e,currentPost:o})),(0,t.createElement)("td",{className:"pll-default-lang-column pll-column-icon"},e.is_default_lang&&(0,t.createElement)(W,null))),!P()&&(0,t.createElement)(t.Fragment,null,(0,t.createElement)("td",{className:"pll-edit-column pll-column-icon"},(0,t.createElement)(nt,{translationData:e})),(0,t.createElement)("td",{className:"pll-sync-column pll-column-icon"},e.can_synchronize&&(0,t.createElement)(Q,{translationData:e})),(0,t.createElement)("td",{className:"pll-translation-column"},(0,t.createElement)("label",{className:"screen-reader-text",htmlFor:`tr_lang_${e.lang.slug}`},(0,i.__)("Translation","polylang-pro")),(0,t.createElement)(Ot,{id:`htr_lang_${e.lang.slug}`,autoFocus:!1,translationsTable:s,translatedPosts:l,translationData:e,value:(0,a.isUndefined)(e.translated_post)?"":e.translated_post.title,onChange:Rt})))))))))};class zt extends t.Component{render(){return this.props.isAllowedPostType?(0,t.createElement)("div",{className:"components-panel__body is-opened"},(0,a.isNil)(this.props.selectedLanguage)?(0,t.createElement)("div",{className:"pll-metabox-error components-notice is-error"},(0,i.__)("Unable to retrieve the content language","polylang-pro")):(0,t.createElement)("form",{className:"pll-metabox-location"},"wp_template_part"===this.props.currentPost.type?(0,t.createElement)(t.Fragment,null,(0,t.createElement)(H,{language:this.props.selectedLanguage,translationsTable:this.props.translationsTable})):(0,t.createElement)(t.Fragment,null,(0,t.createElement)(j,{selectedLanguage:this.props.selectedLanguage}),(0,t.createElement)(K,null)),(0,t.createElement)(Ft,{selectedLanguage:this.props.selectedLanguage,translationsTable:this.props.translationsTable,translatedPosts:this.props.translatedPosts,currentPost:this.props.currentPost}))):(0,t.createElement)("div",{className:"components-panel__body is-opened"},(0,t.createElement)("div",{className:"pll-metabox-error components-notice is-warning"},(0,i.__)("Templates are not translatable, only template parts are.","polylang-pro")))}}const It=(0,l.withSelect)((t=>{let e="",n=[],s=[],l={},o=!1;l=P()?tt():t(_).getCurrentPost(),o=!(0,a.isNil)(l)&&!w.includes(l.type),(0,a.isNil)(l)||(e=l.lang,n=l.translations_table,s=l.translations);return{currentPost:l,selectedLanguage:S(e),translationsTable:x(n),translatedPosts:T(s,n,e),isAllowedPostType:o}}))(zt),Bt=It,Vt=()=>P()?(0,t.createElement)(r.PluginSidebar,{name:"polylang-sidebar",title:(0,i.__)("Languages","polylang-pro")},(0,t.createElement)(Bt,null)):(0,t.createElement)(o.PluginSidebar,{name:"polylang-sidebar",title:(0,i.__)("Languages","polylang-pro")},(0,t.createElement)(Bt,null)),jt=()=>(0,t.createElement)(o.PluginSidebarMoreMenuItem,{target:"polylang-sidebar"},(0,i.__)("Languages","polylang-pro")),Wt=()=>(0,t.createElement)(t.Fragment,null,(0,t.createElement)(Vt,null),(0,t.createElement)(jt,null));if(P()){const t=t=>{const e=new URL(t).searchParams,n=e.get("postType"),s=e.get("postId");pll_block_editor_plugin_settings.lang.is_default_lang||!(0,a.isNil)(s)||(0,a.isNil)(n)||(0,a.isEmpty)((0,a.intersection)([n],["wp_template","wp_template_part"]))||(0,l.dispatch)(v).invalidateResolutionForStore()};window.onpopstate=e=>{t(document.location.href)},(e=>{const n=e.pushState,s=e.replaceState;e.pushState=(s,l,a)=>(t(a),n.apply(e,[s,l,a])),e.replaceState=(n,l,a)=>(t(a),s.apply(e,[n,l,a]))})(window.history),(()=>{Z();const t=new Promise((function(t){let e=(0,l.subscribe)((function(){const n=(0,l.select)(f).getCurrentUser();(0,a.isNil)(n)||(0,a.isEmpty)(n)||(e(),t())}))})),e=new Promise((function(t){let e=(0,l.subscribe)((function(){const n=tt();(0,a.isNil)(n)||(0,a.isEmpty)(n)||(e(),t())}))}));return Promise.all([t,e,J]).then((()=>{const t=(0,l.select)(f).getCurrentUser();(0,a.isString)(t.pll_duplicate_content)&&(t.pll_duplicate_content={}),t.pll_duplicate_content.wp_template_part=!0,(0,l.dispatch)(f).setCurrentUser({pll_duplicate_content:t.pll_duplicate_content},!0)}))})().then((function(t){(0,e.registerPlugin)("polylang-sidebar",{icon:M,render:Wt})}))}else(()=>{Z(),(0,l.select)(f).getCurrentUser();const t=new Promise((function(t){let e=(0,l.subscribe)((function(){const n=(0,l.select)(_).getCurrentPost();(0,a.isEmpty)(n)||(e(),t())}))}));return Promise.all([t,J]).then((function(){const t=(0,l.select)(f).getFromPost();if(!(0,a.isNil)(t)&&!(0,a.isNil)(t.id)){const t=(0,l.select)(_).getEditedPostAttribute("lang"),e=T((0,l.select)(_).getEditedPostAttribute("translations"),(0,l.select)(_).getEditedPostAttribute("translations_table"),t);(0,l.dispatch)(_).editPost({translations:b(e)})}}))})().then((function(t){(0,e.registerPlugin)("polylang-sidebar",{icon:M,render:Wt})}))})(),this["polylang-pro"]=s})();